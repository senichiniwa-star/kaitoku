<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÁØâÂú∞Ë≤ùÂæ≥ „Éâ„É™„É≥„ÇØÊ≥®ÊñáÁÆ°ÁêÜ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Hiragino Sans', 'Yu Gothic', sans-serif; }
        .flash { animation: flash 0.3s ease-out; }
        @keyframes flash {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); background-color: #4ade80; }
            100% { transform: scale(1); }
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            overflow-y: auto;
        }
        .modal.show {
            display: flex;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-50 to-slate-100 min-h-screen">
    <div id="app" class="p-4 md:p-6"></div>
    
    <!-- ‰æ°Ê†ºÁ∑®ÈõÜ„É¢„Éº„ÉÄ„É´ -->
    <div id="priceModal" class="modal">
        <div class="bg-white rounded-xl shadow-2xl p-6 max-w-2xl w-full mx-4 my-8 max-h-[80vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-slate-800">„Éâ„É™„É≥„ÇØ‰æ°Ê†ºË®≠ÂÆö</h2>
                <button onclick="closePriceModal()" class="text-slate-400 hover:text-slate-600 text-3xl">&times;</button>
            </div>
            <div id="priceEditList" class="space-y-3"></div>
            <div class="mt-6 flex gap-3">
                <button onclick="savePrices()" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg">
                    ‰øùÂ≠ò
                </button>
                <button onclick="resetPrices()" class="flex-1 bg-red-600 hover:bg-red-700 text-white font-bold py-3 rounded-lg">
                    „Éá„Éï„Ç©„É´„Éà„Å´Êàª„Åô
                </button>
            </div>
        </div>
    </div>

    <!-- „Éâ„É™„É≥„ÇØÁÆ°ÁêÜ„É¢„Éº„ÉÄ„É´ -->
    <div id="drinkManageModal" class="modal">
        <div class="bg-white rounded-xl shadow-2xl p-6 max-w-2xl w-full mx-4 my-8 max-h-[80vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-slate-800">„Éâ„É™„É≥„ÇØ„É°„Éã„É•„ÉºÁÆ°ÁêÜ</h2>
                <button onclick="closeDrinkManageModal()" class="text-slate-400 hover:text-slate-600 text-3xl">&times;</button>
            </div>

            <!-- „Éâ„É™„É≥„ÇØËøΩÂä† -->
            <div class="mb-6 p-4 bg-slate-50 rounded-lg">
                <h3 class="font-bold text-slate-700 mb-3">Êñ∞„Åó„ÅÑ„Éâ„É™„É≥„ÇØ„ÇíËøΩÂä†</h3>
                <div class="space-y-2">
                    <input type="text" id="newDrinkName" placeholder="„Éâ„É™„É≥„ÇØÂêç"
                        class="w-full px-4 py-2 border-2 border-slate-300 rounded-lg focus:border-blue-500 focus:outline-none">
                    <div class="flex gap-2">
                        <input type="number" id="newDrinkPrice" placeholder="‰æ°Ê†º" min="0" step="100"
                            class="flex-1 px-4 py-2 border-2 border-slate-300 rounded-lg focus:border-blue-500 focus:outline-none">
                        <button onclick="addDrink()"
                            class="bg-blue-600 hover:bg-blue-700 text-white font-bold px-6 py-2 rounded-lg transition-colors">
                            ËøΩÂä†
                        </button>
                    </div>
                </div>
            </div>

            <!-- „Éâ„É™„É≥„ÇØ„É™„Çπ„Éà -->
            <div>
                <h3 class="font-bold text-slate-700 mb-3">„Éâ„É™„É≥„ÇØ„É™„Çπ„Éà</h3>
                <div id="drinkManageList" class="space-y-2"></div>
            </div>

            <div class="mt-6">
                <button onclick="closeDrinkManageModal()"
                    class="w-full bg-slate-600 hover:bg-slate-700 text-white font-bold py-3 rounded-lg transition-colors">
                    Èñâ„Åò„Çã
                </button>
            </div>
        </div>
    </div>

    <script>
        const defaultDrinkMenu = [
            { id: 1, name: '„ÅäÊ∞¥', price: 0 },
            { id: 2, name: 'ÁÇ≠ÈÖ∏Ê∞¥', price: 0 },
            { id: 3, name: '„ÅäËå∂', price: 0 },
            { id: 4, name: '„Éè„Ç§„Éú„Éº„É´ÔºàÁîü„Éì„Éº„É´Ôºâ', price: 700 },
            { id: 5, name: '„Ç¢„Çµ„ÉíÈªíÁîüÔºàÁì∂„Éì„Éº„É´Ôºâ', price: 700 },
            { id: 6, name: '„Éè„Ç§„Éú„Éº„É´', price: 700 },
            { id: 7, name: '„Ç¶„Ç§„Çπ„Ç≠„Éº „Ç∏„É£„ÉÉ„ÇØ„ÉÄ„Éã„Ç®„É´', price: 2500 },
            { id: 8, name: '„Ç¶„Ç§„Çπ„Ç≠„Éº „Çµ„É≥„Éà„É™„ÉºËßí', price: 2500 },
            { id: 9, name: 'ÁÑºÈÖéÔºàDAIYAMEÔºâ', price: 1200 },
            { id: 10, name: 'Êó•Êú¨ÈÖíÔºàÈÖîÈØ®Ôºâ', price: 1200 },
            { id: 11, name: 'Êó•Êú¨ÈÖíÔºàÊôØËôéÔºâ', price: 1200 },
            { id: 12, name: 'Ëµ§„ÉØ„Ç§„É≥', price: 2000 },
            { id: 13, name: 'ÁôΩ„ÉØ„Ç§„É≥', price: 2000 },
            { id: 14, name: '„ÇΩ„Éï„Éà„Éâ„É™„É≥„ÇØ„ÄÄÂêÑÁ®Æ', price: 300 },
            { id: 15, name: '„ÉØ„Ç§„É≥ÊåÅ„Å°Ëæº„Åø', price: 4000 },
        ];

        let drinkMenu = [];
        let orders = {};
        let selectedSeat = 1;
        let flashingDrink = null;
        let salesHistory = [];
        let currentView = 'order';

        function initializeDrinkMenu() {
            try {
                const savedMenu = localStorage.getItem('tsukiji_drink_menu');
                if (savedMenu) {
                    drinkMenu = JSON.parse(savedMenu);
                } else {
                    drinkMenu = JSON.parse(JSON.stringify(defaultDrinkMenu));
                    saveDrinkMenu();
                }
            } catch (e) {
                console.error('„É°„Éã„É•„ÉºË™≠„ÅøËæº„Åø„Ç®„É©„Éº:', e);
                drinkMenu = JSON.parse(JSON.stringify(defaultDrinkMenu));
            }
        }

        function saveDrinkMenu() {
            try {
                localStorage.setItem('tsukiji_drink_menu', JSON.stringify(drinkMenu));
            } catch (e) {
                console.error('„É°„Éã„É•„Éº‰øùÂ≠ò„Ç®„É©„Éº:', e);
            }
        }

        function addDrink() {
            const name = document.getElementById('newDrinkName').value.trim();
            const price = parseInt(document.getElementById('newDrinkPrice').value) || 0;
            
            if (!name) {
                alert('„Éâ„É™„É≥„ÇØÂêç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }
            
            const maxId = drinkMenu.length > 0 ? Math.max(...drinkMenu.map(d => d.id)) : 0;
            drinkMenu.push({
                id: maxId + 1,
                name: name,
                price: price
            });
            
            saveDrinkMenu();
            document.getElementById('newDrinkName').value = '';
            document.getElementById('newDrinkPrice').value = '';
            renderDrinkManageModal();
            render();
        }

        function deleteDrink(id) {
            const drink = drinkMenu.find(d => d.id === id);
            if (confirm(`„Äå${drink.name}„Äç„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü`)) {
                drinkMenu = drinkMenu.filter(d => d.id !== id);
                saveDrinkMenu();
                renderDrinkManageModal();
                render();
            }
        }

        function openDrinkManageModal() {
            const modal = document.getElementById('drinkManageModal');
            renderDrinkManageModal();
            modal.classList.add('show');
        }

        function closeDrinkManageModal() {
            const modal = document.getElementById('drinkManageModal');
            modal.classList.remove('show');
        }

        function renderDrinkManageModal() {
            const list = document.getElementById('drinkManageList');
            list.innerHTML = drinkMenu.map(drink => `
                <div class="flex items-center justify-between p-3 bg-slate-50 rounded-lg">
                    <div class="flex-1">
                        <div class="font-bold text-slate-800">${drink.name}</div>
                        <div class="text-sm text-slate-600">${drink.price === 0 ? 'ÁÑ°Êñô' : '¬•' + drink.price.toLocaleString()}</div>
                    </div>
                    <button onclick="deleteDrink(${drink.id})" 
                        class="text-red-600 hover:text-red-800 font-bold">
                        ÂâäÈô§
                    </button>
                </div>
            `).join('');
        }

        function loadData() {
            try {
                const data = localStorage.getItem('tsukiji_kaitoku_sales');
                if (data) {
                    salesHistory = JSON.parse(data);
                }
            } catch (e) {
                console.log('„Éá„Éº„ÇøË™≠„ÅøËæº„Åø„Ç®„É©„Éº:', e);
            }
        }

        function saveData() {
            try {
                localStorage.setItem('tsukiji_kaitoku_sales', JSON.stringify(salesHistory));
            } catch (e) {
                console.error('„Éá„Éº„Çø‰øùÂ≠ò„Ç®„É©„Éº:', e);
            }
        }

        function openPriceModal() {
            const modal = document.getElementById('priceModal');
            const list = document.getElementById('priceEditList');
            
            list.innerHTML = drinkMenu.map(drink => `
                <div class="flex items-center gap-3 p-3 bg-slate-50 rounded-lg">
                    <div class="flex-1 font-medium text-slate-800">${drink.name}</div>
                    <div class="flex items-center gap-2">
                        <span class="text-slate-600">¬•</span>
                        <input 
                            type="number" 
                            id="price-${drink.id}"
                            value="${drink.price}"
                            min="0"
                            step="100"
                            class="w-24 px-3 py-2 border-2 border-slate-300 rounded-lg font-bold text-right focus:border-blue-500 focus:outline-none"
                        >
                    </div>
                </div>
            `).join('');
            
            modal.classList.add('show');
        }

        function closePriceModal() {
            const modal = document.getElementById('priceModal');
            modal.classList.remove('show');
        }

        function savePrices() {
            drinkMenu.forEach(drink => {
                const input = document.getElementById(`price-${drink.id}`);
                if (input) {
                    drink.price = parseInt(input.value) || 0;
                }
            });
            saveDrinkMenu();
            closePriceModal();
            render();
            alert('‰æ°Ê†º„Çí‰øùÂ≠ò„Åó„Åæ„Åó„Åü');
        }

        function resetPrices() {
            if (confirm('‰æ°Ê†º„Çí„Éá„Éï„Ç©„É´„Éà„Å´Êàª„Åó„Åæ„Åô„ÅãÔºü')) {
                drinkMenu = JSON.parse(JSON.stringify(defaultDrinkMenu));
                saveDrinkMenu();
                closePriceModal();
                render();
                alert('‰æ°Ê†º„Çí„É™„Çª„ÉÉ„Éà„Åó„Åæ„Åó„Åü');
            }
        }

        function addOrder(drink) {
            if (!orders[selectedSeat]) orders[selectedSeat] = [];
            orders[selectedSeat].push({ ...drink, orderId: Date.now() });
            
            flashingDrink = drink.id;
            setTimeout(() => {
                flashingDrink = null;
                render();
            }, 300);
            
            render();
        }

        function removeOrder(seat, orderId) {
            orders[seat] = orders[seat].filter(o => o.orderId !== orderId);
            if (orders[seat].length === 0) delete orders[seat];
            render();
        }

        function calculateSeatTotal(seat) {
            if (!orders[seat]) return 0;
            return orders[seat].reduce((sum, o) => sum + o.price, 0);
        }

        function calculateAllTotal() {
            return Object.keys(orders).reduce((sum, seat) => sum + calculateSeatTotal(parseInt(seat)), 0);
        }

        function checkoutSeat(seat) {
            if (orders[seat] && orders[seat].length > 0) {
                const total = calculateSeatTotal(seat);
                const saleRecord = {
                    timestamp: new Date().toISOString(),
                    date: new Date().toLocaleDateString('ja-JP'),
                    time: new Date().toLocaleTimeString('ja-JP'),
                    seat: seat,
                    items: orders[seat].map(o => ({ name: o.name, price: o.price })),
                    total: total
                };
                salesHistory.push(saleRecord);
                saveData();
                
                alert(`Â∏≠${seat}Áï™Ôºö„Åä‰ºöË®à ¬•${total.toLocaleString()}\n\nÂ£≤‰∏ä„Éá„Éº„Çø„Å´Ë®òÈå≤„Åó„Åæ„Åó„Åü`);
                delete orders[seat];
                render();
            }
        }

        function checkoutAll() {
            const total = calculateAllTotal();
            if (total > 0) {
                const seats = Object.keys(orders).filter(s => orders[s]?.length > 0);
                const allItems = [];
                seats.forEach(seat => {
                    orders[seat].forEach(o => allItems.push({ name: o.name, price: o.price }));
                });
                
                const saleRecord = {
                    timestamp: new Date().toISOString(),
                    date: new Date().toLocaleDateString('ja-JP'),
                    time: new Date().toLocaleTimeString('ja-JP'),
                    seat: seats.join(','),
                    items: allItems,
                    total: total
                };
                salesHistory.push(saleRecord);
                saveData();
                
                alert(`„Åæ„Å®„ÇÅ„Å¶„Åä‰ºöË®àÔºàÂ∏≠${seats.join(', ')}Áï™ÔºâÔºö¬•${total.toLocaleString()}\n\nÂ£≤‰∏ä„Éá„Éº„Çø„Å´Ë®òÈå≤„Åó„Åæ„Åó„Åü`);
                orders = {};
                render();
            }
        }

        function getDrinkStats(month = null) {
            const stats = {};
            const filteredSales = month 
                ? salesHistory.filter(s => s.date.startsWith(month))
                : salesHistory;
            
            filteredSales.forEach(sale => {
                sale.items.forEach(item => {
                    if (!stats[item.name]) {
                        stats[item.name] = { count: 0, total: 0 };
                    }
                    stats[item.name].count++;
                    stats[item.name].total += item.price;
                });
            });
            
            return Object.entries(stats)
                .sort((a, b) => b[1].count - a[1].count);
        }

        function getMonthlyTotal(month = null) {
            const filteredSales = month 
                ? salesHistory.filter(s => s.date.startsWith(month))
                : salesHistory;
            return filteredSales.reduce((sum, sale) => sum + sale.total, 0);
        }

        function clearSalesData() {
            if (confirm('Êú¨ÂΩì„Å´Â£≤‰∏ä„Éá„Éº„Çø„ÇíÂÖ®„Å¶ÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü\n„Åì„ÅÆÊìç‰Ωú„ÅØÂèñ„ÇäÊ∂à„Åõ„Åæ„Åõ„Çì„ÄÇ')) {
                salesHistory = [];
                saveData();
                alert('Â£≤‰∏ä„Éá„Éº„Çø„ÇíÂâäÈô§„Åó„Åæ„Åó„Åü');
                render();
            }
        }

        function escapeCSV(value) {
            if (value == null) return '""';
            const str = String(value);
            const escaped = str.replace(/"/g, '""');
            return `"${escaped}"`;
        }

        function downloadCSV() {
            if (salesHistory.length === 0) {
                alert('„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åô„ÇãÂ£≤‰∏ä„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì');
                return;
            }

            let csv = 'Êó•‰ªò,ÊôÇÈñì,Â∏≠Áï™Âè∑,„Éâ„É™„É≥„ÇØÂêç,Âçò‰æ°,‰ºöË®àÂêàË®à\n';
            
            salesHistory.forEach(sale => {
                sale.items.forEach((item, index) => {
                    if (index === 0) {
                        csv += `${escapeCSV(sale.date)},${escapeCSV(sale.time)},${escapeCSV(sale.seat + 'Áï™')},${escapeCSV(item.name)},${escapeCSV('¬•' + item.price)},${escapeCSV('¬•' + sale.total)}\n`;
                    } else {
                        csv += `${escapeCSV('')},${escapeCSV('')},${escapeCSV('')},${escapeCSV(item.name)},${escapeCSV('¬•' + item.price)},${escapeCSV('')}\n`;
                    }
                });
            });

            const bom = new Uint8Array([0xEF, 0xBB, 0xBF]);
            const blob = new Blob([bom, csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            
            const link = document.createElement('a');
            const today = new Date().toISOString().split('T')[0];
            link.href = url;
            link.download = `ÁØâÂú∞Ë≤ùÂæ≥_Â£≤‰∏ä„Éá„Éº„Çø_${today}.csv`;
            link.click();
            
            URL.revokeObjectURL(url);
            
            alert('CSV„Éï„Ç°„Ç§„É´„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„Åæ„Åó„Åü');
        }

        window.clearSalesData = clearSalesData;
        window.downloadCSV = downloadCSV;
        window.openPriceModal = openPriceModal;
        window.closePriceModal = closePriceModal;
        window.savePrices = savePrices;
        window.resetPrices = resetPrices;
        window.openDrinkManageModal = openDrinkManageModal;
        window.closeDrinkManageModal = closeDrinkManageModal;
        window.addDrink = addDrink;
        window.deleteDrink = deleteDrink;

        function renderAnalytics() {
            const stats = getDrinkStats();
            const monthlyTotal = getMonthlyTotal();

            return `
                <div class="max-w-6xl mx-auto">
                    <div class="bg-white rounded-lg shadow-lg p-4 md:p-6 mb-4 md:mb-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <h1 class="text-2xl md:text-3xl font-bold text-slate-800 mb-2">Â£≤‰∏äÂàÜÊûê</h1>
                                <p class="text-slate-600">„Éá„Éº„ÇøÊï∞Ôºö${salesHistory.length}‰ª∂</p>
                            </div>
                            <button onclick="currentView='order'; render();"
                                class="bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-2 rounded-lg">
                                Ê≥®ÊñáÁîªÈù¢„Å∏
                            </button>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div class="bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-lg shadow-lg p-6">
                            <div class="text-sm opacity-90 mb-2">Á¥ØË®àÂ£≤‰∏ä</div>
                            <div class="text-3xl font-bold">¬•${monthlyTotal.toLocaleString()}</div>
                        </div>
                        <div class="bg-gradient-to-br from-green-600 to-green-700 text-white rounded-lg shadow-lg p-6">
                            <div class="text-sm opacity-90 mb-2">‰ºöË®àÊï∞</div>
                            <div class="text-3xl font-bold">${salesHistory.length}‰ª∂</div>
                        </div>
                        <div class="bg-gradient-to-br from-purple-600 to-purple-700 text-white rounded-lg shadow-lg p-6">
                            <div class="text-sm opacity-90 mb-2">Âπ≥ÂùáÂçò‰æ°</div>
                            <div class="text-3xl font-bold">¬•${salesHistory.length > 0 ? Math.round(monthlyTotal / salesHistory.length).toLocaleString() : 0}</div>
                        </div>
                    </div>

                    <div class="bg-white rounded-lg shadow-lg p-4 md:p-6 mb-6">
                        <h2 class="text-xl font-bold text-slate-800 mb-4">„Éâ„É™„É≥„ÇØÂà•Â£≤‰∏ä</h2>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left">
                                <thead>
                                    <tr class="border-b-2 border-slate-200">
                                        <th class="pb-3 font-bold text-slate-700">„Éâ„É™„É≥„ÇØÂêç</th>
                                        <th class="pb-3 font-bold text-slate-700 text-right">Êú¨Êï∞</th>
                                        <th class="pb-3 font-bold text-slate-700 text-right">Â£≤‰∏ä</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${stats.map(([name, data]) => `
                                        <tr class="border-b border-slate-100">
                                            <td class="py-3 text-slate-800">${name}</td>
                                            <td class="py-3 text-right font-bold text-blue-600">${data.count}Êú¨</td>
                                            <td class="py-3 text-right font-bold text-slate-800">¬•${data.total.toLocaleString()}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="bg-white rounded-lg shadow-lg p-4 md:p-6 mb-6">
                        <h2 class="text-xl font-bold text-slate-800 mb-4">‰ºöË®àÂ±•Ê≠¥ÔºàÊúÄÊñ∞20‰ª∂Ôºâ</h2>
                        <div class="space-y-3 max-h-96 overflow-y-auto">
                            ${salesHistory.slice(-20).reverse().map(sale => `
                                <div class="border border-slate-200 rounded-lg p-3">
                                    <div class="flex justify-between items-start mb-2">
                                        <div class="text-sm text-slate-600">${sale.date} ${sale.time} - Â∏≠${sale.seat}Áï™</div>
                                        <div class="font-bold text-blue-600">¬•${sale.total.toLocaleString()}</div>
                                    </div>
                                    <div class="text-xs text-slate-500">
                                        ${sale.items.map(item => item.name).join(', ')}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div class="bg-white rounded-lg shadow-lg p-4 md:p-6">
                        <h2 class="text-xl font-bold text-slate-800 mb-4">„Éá„Éº„ÇøÁÆ°ÁêÜ</h2>
                        <div class="space-y-3">
                            <button onclick="downloadCSV()"
                                class="bg-blue-600 hover:bg-blue-700 text-white font-bold px-6 py-3 rounded-lg w-full text-lg">
                                üì• Â£≤‰∏ä„Éá„Éº„Çø„ÇíCSV„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
                            </button>
                            <button onclick="clearSalesData()"
                                class="bg-red-600 hover:bg-red-700 text-white font-bold px-6 py-3 rounded-lg w-full text-lg">
                                üóëÔ∏è Â£≤‰∏ä„Éá„Éº„Çø„ÇíÂÖ®„Å¶ÂâäÈô§
                            </button>
                        </div>
                        <p class="text-sm text-slate-500 mt-2">‚ÄªÂâäÈô§„Åó„Åü„Éá„Éº„Çø„ÅØÂæ©ÂÖÉ„Åß„Åç„Åæ„Åõ„Çì</p>
                    </div>
                </div>
            `;
        }

        function renderOrder() {
            return `
                <div class="max-w-6xl mx-auto">
                    <div class="bg-white rounded-lg shadow-lg p-4 md:p-6 mb-4 md:mb-6">
                        <div class="flex items-center justify-between flex-wrap gap-3">
                            <div>
                                <h1 class="text-2xl md:text-3xl font-bold text-slate-800 mb-2">ÁØâÂú∞Ë≤ùÂæ≥</h1>
                                <p class="text-slate-600">„Éâ„É™„É≥„ÇØÊ≥®ÊñáÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É†</p>
                            </div>
                            <div class="flex gap-2 flex-wrap">
                                <button onclick="openDrinkManageModal()"
                                    class="bg-orange-600 hover:bg-orange-700 text-white font-medium px-4 py-2 rounded-lg">
                                    üç∫ „É°„Éã„É•„ÉºÁÆ°ÁêÜ
                                </button>
                                <button onclick="openPriceModal()"
                                    class="bg-purple-600 hover:bg-purple-700 text-white font-medium px-4 py-2 rounded-lg">
                                    ‚öôÔ∏è ‰æ°Ê†ºË®≠ÂÆö
                                </button>
                                <button onclick="currentView='analytics'; render();"
                                    class="bg-green-600 hover:bg-green-700 text-white font-medium px-4 py-2 rounded-lg">
                                    üìä Â£≤‰∏äÂàÜÊûê
                                </button>
                                <a href="index.html"
                                    class="bg-slate-600 hover:bg-slate-700 text-white font-medium px-4 py-2 rounded-lg">
                                    ‚Üê „Éà„ÉÉ„Éó„Å∏
                                </a>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 md:gap-6">
                        <div class="lg:col-span-2 space-y-4 md:space-y-6">
                            <div class="bg-white rounded-lg shadow-lg p-4 md:p-6">
                                <h2 class="text-lg md:text-xl font-bold text-slate-800 mb-4">Â∏≠„ÇíÈÅ∏Êäû</h2>
                                <div class="grid grid-cols-4 gap-2 md:gap-3">
                                    ${[1,2,3,4,5,6,7,8].map(seat => `
                                        <button onclick="selectedSeat=${seat}; render();" 
                                            class="p-3 md:p-4 rounded-lg font-bold text-base md:text-lg transition-all ${
                                                selectedSeat === seat
                                                    ? 'bg-blue-600 text-white shadow-lg scale-105'
                                                    : orders[seat]?.length > 0
                                                    ? 'bg-amber-100 text-amber-800 hover:bg-amber-200'
                                                    : 'bg-slate-100 text-slate-600 hover:bg-slate-200'
                                            }">
                                            ${seat}Áï™
                                            ${orders[seat]?.length > 0 ? `<div class="text-xs mt-1">(${orders[seat].length}ÂìÅ)</div>` : ''}
                                        </button>
                                    `).join('')}
                                </div>
                            </div>

                            <div class="bg-white rounded-lg shadow-lg p-4 md:p-6">
                                <h2 class="text-lg md:text-xl font-bold text-slate-800 mb-4">
                                    „Éâ„É™„É≥„ÇØ„É°„Éã„É•„ÉºÔºàÂ∏≠${selectedSeat}Áï™Ôºâ
                                </h2>
                                <div class="grid grid-cols-2 sm:grid-cols-3 gap-2 md:gap-3">
                                    ${drinkMenu.map(drink => `
                                        <button onclick="addOrder(${JSON.stringify(drink).replace(/"/g, '&quot;')})"
                                            class="flex flex-col items-start justify-between p-2 md:p-3 rounded-lg transition-all duration-200 border-2 active:scale-95 ${
                                                flashingDrink === drink.id
                                                    ? 'bg-green-400 border-green-500'
                                                    : 'bg-slate-50 hover:bg-blue-50 border-transparent hover:border-blue-300'
                                            }">
                                            <span class="font-medium text-xs md:text-sm ${
                                                flashingDrink === drink.id ? 'text-white' : 'text-slate-800'
                                            }">
                                                ${drink.name}
                                            </span>
                                            <div class="flex items-center gap-1 md:gap-2 mt-1 md:mt-2">
                                                <span class="font-bold text-sm md:text-base ${
                                                    flashingDrink === drink.id ? 'text-white' : 'text-blue-600'
                                                }">
                                                    ${drink.price === 0 ? 'ÁÑ°Êñô' : `¬•${drink.price.toLocaleString()}`}
                                                </span>
                                            </div>
                                        </button>
                                    `).join('')}
                                </div>
                            </div>
                        </div>

                        <div class="space-y-4 md:space-y-6">
                            <div class="bg-white rounded-lg shadow-lg p-4 md:p-6">
                                <h2 class="text-lg md:text-xl font-bold text-slate-800 mb-4">ÁèæÂú®„ÅÆÊ≥®Êñá</h2>
                                <div class="space-y-4 max-h-96 overflow-y-auto">
                                    ${Object.keys(orders).sort((a,b) => a-b).map(seat => {
                                        const seatOrders = orders[seat];
                                        if (!seatOrders || seatOrders.length === 0) return '';
                                        return `
                                            <div class="border-2 border-slate-200 rounded-lg p-3 md:p-4">
                                                <div class="flex items-center justify-between mb-3">
                                                    <h3 class="font-bold text-slate-800">Â∏≠${seat}Áï™</h3>
                                                    <span class="font-bold text-blue-600">
                                                        ¬•${calculateSeatTotal(parseInt(seat)).toLocaleString()}
                                                    </span>
                                                </div>
                                                <div class="space-y-2">
                                                    ${seatOrders.map(order => `
                                                        <div class="flex items-center justify-between text-sm bg-slate-50 p-2 rounded">
                                                            <span class="text-slate-700">${order.name}</span>
                                                            <div class="flex items-center gap-2">
                                                                <span class="text-slate-600">
                                                                    ${order.price === 0 ? 'ÁÑ°Êñô' : `¬•${order.price.toLocaleString()}`}
                                                                </span>
                                                                <button onclick="removeOrder(${seat}, ${order.orderId})"
                                                                    class="text-red-500 hover:text-red-700 text-xl">
                                                                    √ó
                                                                </button>
                                                            </div>
                                                        </div>
                                                    `).join('')}
                                                </div>
                                                <button onclick="checkoutSeat(${seat})"
                                                    class="w-full mt-3 bg-green-600 hover:bg-green-700 text-white font-medium py-2 rounded-lg transition-colors">
                                                    üí∞ ÂÄãÂà•‰ºöË®à
                                                </button>
                                            </div>
                                        `;
                                    }).join('')}
                                </div>
                            </div>

                            ${calculateAllTotal() > 0 ? `
                                <div class="bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg shadow-lg p-4 md:p-6 text-white">
                                    <h2 class="text-lg md:text-xl font-bold mb-4">ÂêàË®àÈáëÈ°ç</h2>
                                    <div class="text-3xl md:text-4xl font-bold mb-4">
                                        ¬•${calculateAllTotal().toLocaleString()}
                                    </div>
                                    <button onclick="checkoutAll()"
                                        class="w-full bg-white text-blue-700 font-bold py-2 md:py-3 rounded-lg hover:bg-blue-50 transition-colors">
                                        üë• „Åæ„Å®„ÇÅ„Å¶‰ºöË®à
                                    </button>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `;
        }

        function render() {
            const app = document.getElementById('app');
            app.innerHTML = currentView === 'analytics' ? renderAnalytics() : renderOrder();
        }

        initializeDrinkMenu();
        loadData();
        render();
    </script>
</body>
</html>